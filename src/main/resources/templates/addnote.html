<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head"></head>

<body>
  <div th:replace="fragments/header :: header"></div>

  <div class="container-fluid">
    <h1>Add Note</h1>
    <form action="#" th:action="@{/add-note}" th:object="${note}" method="post">
      <div class="form-group">
        <label for="district">District:</label>
        <select class="form-control" id="district" name="district.did" required>
          <option value="" selected>Select District</option>
          <option th:each="district : ${districts}" th:value="${district.did}" th:text="${district.district}"></option>
        </select>
      </div>
      <div class="form-group">
        <label for="locale">Locale:</label>
        <select class="form-control" id="locale" name="locale" required>
          <option value="" selected>Select Locale</option>
        </select>
      </div>
      <div class="form-group">
        <label for="wkno">Week Number:</label>
        <input type="text" class="form-control" id="wkno" name="wkno" pattern="[0-9]{2}-[0-9]{4}" required>
        <div class="invalid-feedback">
          Please enter a valid week number (week-yyyy).
        </div>
      </div>
      <div class="form-group">
        <label for="concerns">Concerns:</label>
        <textarea class="form-control" id="concerns" name="concerns" required></textarea>
      </div>
      <div class="form-group">
        <label for="action">Action:</label>
        <textarea class="form-control" id="action" name="action" required></textarea>
      </div>
      <div class="form-group">
        <label for="actionDate">Action Date:</label>
        <input type="date" class="form-control" id="actionDate" name="actionDate" required>
      </div>
      <button type="submit" class="btn btn-primary">Add Note</button>
    </form>
  </div>

  <div th:replace="fragments/footer :: footer"></div>

  <script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
  <script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js}"></script>
  <script>
    $(document).ready(function () {
      $('#district').change(function () {
        var did = $(this).val();
        $.get('/get-locales/' + did, function (data) {
          $('#locale').empty();
          $('#locale').append($('<option>').val('').text('Select Locale'));
          $.each(data, function (i, locale) {
            $('#locale').append($('<option>').val(locale.lcode).text(locale.name));
          });
        });
      });
    });
  </script>
</body>

</html>
